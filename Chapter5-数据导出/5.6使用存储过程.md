<h2>5.6使用存储过程</h2>

<h3>问题</h3>
数据库已经有一个工作流, 用于摄取大量使用存储过程而不是直接插入语句的新数据

<h3>解决方案</h3>

可以很容易地从 INSERT 语句切换到存储过程。不要使用table参数来指定目标表, 而是使用 **--call**参数, 后跟应调用的存储过程的名称。在下面的示例中, 我们使用名为 populate_cities 的存储过程:

```

sqoop export \
--connect jdbc:mysql://mysql.example.com/sqoop \
--username sqoop \
--password sqoop \
--call populate_cities

```

<h3>讨论</h3>

在 Sqoop 导出中使用存储过程非常简单。Sqoop 将使用输入数据的每一列的值作为单独的参数来调用存储过程, 而不是发出 INSERT 语句。例如,当导出到 MySQL 时,Sqoop使用以下查询。

```
CALL populate_cities(?, ?, ?)
```

在使用导出的存储过程时, 应该记住一些陷阱。Sqoop 是一个专门的批量传输工具, 它将运行多个并发导出任务, 它
们都以并行方式调用存储过程。Sqoop 不会对存储过程复杂性施加任何限制。复杂的过程可能会导致数据库服务器负
载过重, 对其性能产生负面影响。
建议将此功能与非常简单的存储过程一起使用,或者更确切地准备Hadoop边上的数据,以便它可以直接插入到最终表中,
绕过存储过程中的高级逻辑